import{_ as L}from"./VeeForm-Duwk6dER.js";import{u as H,_ as O}from"./Modal-DFIulcsf.js";import{x as R,p as x,y as $,r as p,o as f,k as I,w as v,b as m,a as l,z as w,h as M,s as z,c as C,f as u,F as N,A}from"./index-DhJAbDsU.js";import{a as K}from"./useDocument-p6YVppS_.js";const P={class:"btn-group"},S=R({__name:"EducationItem",props:{modelValue:{type:Object,default:()=>({_id:"",school:"",major:"",startDate:+new Date,endDate:+new Date,isCurrent:!1,description:"",image:""})}},emits:["onEdit","onDelete"],setup(t,{emit:D}){const b=D,g=t,d=x(()=>g.modelValue),a=x(()=>{const{startDate:y,endDate:o,isCurrent:c}=g.modelValue,r=$(y,"MM/YYYY"),_=c?"Hiện tại":$(o,"MM/YYYY");return`${r} - ${_}`}),T=x(()=>({title:d.value.school,subTitle:d.value.major,date:a.value,description:d.value.description}));return(y,o)=>{const c=p("FontAwesomeIcon"),r=p("ItemTemplate");return f(),I(r,{"model-value":T.value},{default:v(()=>[m("div",P,[m("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:o[0]||(o[0]=_=>b("onDelete",{...d.value}))},[l(c,{icon:"fa-solid fa-trash"})]),m("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:o[1]||(o[1]=_=>b("onEdit",{...d.value}))},[l(c,{icon:"fa-solid fa-square-pen"})])])]),_:1},8,["model-value"])}}}),h="Vui lòng nhập",E=[{name:"_id",label:"ID",type:"hidden",placeholder:"Vui lòng nhập Tên trường",valid:t=>t.string().nullable().default(null),col:"col-md-12",default:null},{name:"school",label:"Tên trường",type:"text",placeholder:"Vui lòng nhập Tên trường",valid:t=>t.string().max(100,"Tối đa 100 ký tự").required(h),default:""},{name:"major",label:"Chuyên ngành",type:"text",placeholder:"Vui lòng nhập Chuyên nhành",valid:t=>t.string().max(50,"Tối đa 50 ký tự").required(h),default:""},{name:"startDate",label:"Ngày bắt đầu",type:"date",placeholder:"Vui lòng nhập Ngày bắt đầu",valid:t=>t.date().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"endDate",label:"Ngày Kết thúc",type:"date",placeholder:"Vui lòng nhập Ngày Kết thúc",valid:t=>t.date().required(h).min(t.ref("startDate"),"Ngày kết thúc phải sau ngày bắt đầu"),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"isCurrent",label:"Đang học tại đây",type:"checkbox",placeholder:"",default:!1,valid:t=>t.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},{name:"description",label:"Mô tả",type:"ckediter",valid:t=>t.string().required(h),col:"col-md-12",convertTo:"truncate",default:""}],U={class:"mb-4"},G={class:"btn-group"},J={key:0,class:"clearfix"},Q={class:"block-container"},W=m("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ne={__name:"PageEducation",setup(t){const{educations:D,removeRecordById:b,addRecordToList:g,getData:d}=H({field:"educations",collection:"education"}),{document:a,updateDoc:T,deleteDoc:y}=K({collection:"education",fields:E}),o=M(),c=M(),r=z(E);async function _(s){const n=(e=>(e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),!e.isCurrent&&(e.isCurrent=!1),e))({...s});await T(n,e=>{const{data:i}=e;g(i)})}async function Y(s){y({...s},"school",n=>{const{data:e}=n;b(e._id)})}function q(s){var e;const n=r.value.map(i=>i.name);for(const i of new Set(["_id",...n]))a[i]=s[i];a.startDate=w(a.startDate),a.endDate=w(a.endDate),(e=o.value)==null||e.show()}function B(){var s,n;for(const e of r.value)a[e.name]=e.default;(s=o.value)==null||s.show(),(n=c.value)==null||n.reset()}return(s,n)=>{const e=p("Button"),i=p("Heading"),F=p("ListTransition"),j=p("NoData");return f(),C(N,null,[m("div",U,[l(i,{text:"Học vấn"},{default:v(()=>[m("div",G,[l(e,{onClick:n[0]||(n[0]=k=>B()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),l(e,{onClick:n[1]||(n[1]=k=>{var V;return(V=u(d))==null?void 0:V()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),u(D).length?(f(),C("div",J,[l(F,null,{default:v(()=>[(f(!0),C(N,null,A(u(D),k=>(f(),C("li",{key:k._id},[l(S,{"model-value":k,icon:"fa-graduation-cap",onOnEdit:q,onOnDelete:Y},null,8,["model-value"])]))),128))]),_:1})])):(f(),I(j,{key:1}))]),l(O,{ref_key:"refModal",ref:o,title:u(a)._id?`Chỉnh sửa: ${u(a).school}`:"Thêm mới Học vấn","is-hidden-footer":""},{default:v(()=>[m("div",Q,[l(L,{ref_key:"refVeeForm",ref:c,fields:r.value,document:u(a),"submit-fn":_,"submit-text":u(a)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:v(()=>[W]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ne as default};
