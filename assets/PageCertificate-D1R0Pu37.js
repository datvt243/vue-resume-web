import{_ as H}from"./VeeForm-CBHmjhUX.js";import{u as j,_ as A}from"./Modal-Tzfw6IMV.js";import{h as x,s as K,r as l,o as f,c as _,b as d,a as s,w as u,f as a,k as P,F as C,C as S,J as G,G as v,H as w}from"./index-CpXno4mj.js";import{a as J}from"./useDocument-CkwC1vFX.js";import{d as O,e as U,g as Q,f as W,c as X}from"./model.type-DL4xAfX8.js";const y="Vui lòng nhập",T=[O,{name:"name",label:"Tên Chứng chỉ",type:"text",placeholder:"Vui lòng nhập Tên Chứng chỉ",valid:m=>m.string().max(100,"Tối đa 100 ký tự").required(y),default:""},{name:"organization",label:"Tên tổ chức",type:"text",placeholder:"Vui lòng nhập Tên tổ chức",valid:m=>m.string().max(100,"Tối đa 100 ký tự").required(y),default:""},...U(),Q({name:"isNoExpiration",label:"Không thời hạn"}),W({name:"link",label:"Link"}),X({name:"description",label:"Mô tả"})],Z={class:"mb-4"},tt={class:"btn-group"},et={key:0,class:"clearfix"},nt={class:"btn-group"},at=["onClick"],ot=["onClick"],st={class:"block-container"},it=d("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ut={__name:"PageCertificate",setup(m){const{certificates:g,removeRecordById:E,addRecordToList:M,getData:N}=j({field:"certificates"}),{document:e,updateDoc:$,deleteDoc:B}=J({collection:"certificate",fields:T}),p=x(),D=x(),h=K(T);async function L(c){const n=(t=>(t.startDate=+new Date(t.startDate),t.endDate=+new Date(t.endDate),!t.isNoExpiration&&(t.isNoExpiration=!1),t))({...c});await $(n,t=>{const{data:i}=t;M(i)})}function Y(c){var t;const n=h.value.map(i=>i.name);for(const i of new Set(["_id",...n]))e[i]=c[i];e.startDate=w(e.startDate),e.endDate=w(e.endDate),!e.isNoExpiration&&(e.isNoExpiration=!1),(t=p.value)==null||t.show()}function F(){var c,n;for(const t of h.value)e[t.name]=t.default;(c=p.value)==null||c.show(),(n=D.value)==null||n.reset()}return(c,n)=>{const t=l("Button"),i=l("Heading"),k=l("FontAwesomeIcon"),V=l("ListTransition"),I=l("NoData");return f(),_(C,null,[d("div",Z,[s(i,{text:"Chứng chỉ"},{default:u(()=>[d("div",tt,[s(t,{onClick:n[0]||(n[0]=o=>F()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),s(t,{onClick:n[1]||(n[1]=o=>{var r;return(r=a(N))==null?void 0:r()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),a(g).length?(f(),_("div",et,[s(V,null,{default:u(()=>[(f(!0),_(C,null,S(a(g),o=>(f(),_("li",{key:o._id},[s(G,{"model-value":{title:o.name,subTitle:o.organization,date:()=>{const{startDate:r,endDate:b,isNoExpiration:q}=o,z=a(v)(r,"MM/YYYY"),R=q?"Không thời hạn":a(v)(b,"MM/YYYY");return`${z} - ${R}`},description:o.description},icon:"fa-certificate"},{default:u(()=>[d("div",nt,[d("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:()=>{a(B)({...o},"name",r=>{const{data:b}=r;a(E)(b._id)})}},[s(k,{icon:"fa-solid fa-trash"})],8,at),d("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:r=>Y({...o})},[s(k,{icon:"fa-solid fa-square-pen"})],8,ot)])]),_:2},1032,["model-value"])]))),128))]),_:1})])):(f(),P(I,{key:1}))]),s(A,{ref_key:"refModal",ref:p,title:a(e)._id?`Chỉnh sửa: ${a(e).school}`:"Thêm mới Chứng chỉ","is-hidden-footer":""},{default:u(()=>[d("div",st,[s(H,{ref_key:"refVeeForm",ref:D,fields:h.value,document:a(e),"submit-fn":L,"submit-text":a(e)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:u(()=>[it]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ut as default};
