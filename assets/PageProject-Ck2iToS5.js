import{_ as N}from"./VeeForm-Duwk6dER.js";import{u as W,_ as z}from"./Modal-DFIulcsf.js";import{x as O,p as x,y as $,r as g,o as _,k as L,w as f,B as P,b as c,C as R,a as l,h as j,s as S,c as C,f as m,F as M,A,D as H,z as B}from"./index-DhJAbDsU.js";import{a as U}from"./useDocument-p6YVppS_.js";import{d as G,e as J,f as K,c as Q}from"./model.type-CRXh7ZqH.js";const X={class:"btn-group"},Z=O({__name:"ProjectItem",props:{modelValue:{type:Object,default:()=>({_id:"",name:"",position:"",technology:"",startDate:+new Date,endDate:+new Date,isWorking:!1,description:"",link:"",image:""})}},emits:["onEdit","onDelete"],setup(o,{emit:v}){const k=v,y=o,d=x(()=>y.modelValue),t=x(()=>{const{startDate:h,endDate:a,isWorking:r}=y.modelValue,u=$(h,"MM/YYYY"),D=r?"Hiện tại":$(a,"MM/YYYY");return`${u} - ${D}`}),w=x(()=>({title:d.value.name,subTitle:d.value.position,date:t.value,description:d.value.description}));return(h,a)=>{const r=g("FontAwesomeIcon"),u=g("ItemTemplate");return _(),L(u,{"model-value":w.value},{sub:f(()=>[P(h.$slots,"sub")]),default:f(()=>[c("div",X,[c("a",{class:R(["btn btn-sm btn-outline-danger icon",{disabled:!d.value._id}]),href:"javascript:void(0)",onClick:a[0]||(a[0]=D=>k("onDelete",{...d.value}))},[l(r,{icon:"fa-solid fa-trash"})],2),c("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=D=>k("onEdit",{...d.value}))},[l(r,{icon:"fa-solid fa-square-pen"})])])]),_:3},8,["model-value"])}}}),T="Vui lòng nhập",I=[G,{name:"name",label:"Tên dự án",type:"text",placeholder:"Vui lòng nhập Tên dự án",valid:o=>o.string().max(100,"Tối đa 100 ký tự").required(T),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:o=>o.string().max(50,"Tối đa 50 ký tự").required(T),default:""},{name:"technology",label:"Công nghệ sử dụng",type:"text",placeholder:"Vui lòng nhập Công nghệ sử dụng",valid:o=>o.string().required(T),default:""},...J(),{name:"isWorking",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:o=>o.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},K({name:"link",label:"Link"}),Q({name:"description",label:"Mô tả"})],ee={class:"mb-4"},te={class:"btn-group"},ne={key:0,class:"clearfix"},oe={class:"block-container"},ae=c("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),re={__name:"PageProject",setup(o){const{projects:v,removeRecordById:k,addRecordToList:y,getData:d}=W({field:"projects"}),{document:t,updateDoc:w,deleteDoc:h}=U({collection:"project",fields:I}),a=j(),r=j(),u=S(I);async function D(s){const n=(e=>{var i;return e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),e.technology=(i=e.technology)==null?void 0:i.split(","),!e.isWorking&&(e.isWorking=!1),e})({...s});await w(n,e=>{const{data:i}=e;y(i)})}async function Y(s){h({...s},"name",n=>{const{data:e}=n;k(e._id)})}function E(s){var e,i;const n=u.value.map(p=>p.name);for(const p of new Set(["_id",...n]))t[p]=s[p];t.technology=(e=t.technology)==null?void 0:e.join(", "),t.startDate=B(t.startDate),t.endDate=B(t.endDate),(i=a.value)==null||i.show()}function F(){var s,n;for(const e of u.value)t[e.name]=e.default;(s=a.value)==null||s.show(),(n=r.value)==null||n.reset()}return(s,n)=>{const e=g("Button"),i=g("Heading"),p=g("ListTransition"),q=g("NoData");return _(),C(M,null,[c("div",ee,[l(i,{text:"Dự án"},{default:f(()=>[c("div",te,[l(e,{onClick:n[0]||(n[0]=b=>F()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),l(e,{onClick:n[1]||(n[1]=b=>{var V;return(V=m(d))==null?void 0:V()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),m(v).length?(_(),C("div",ne,[l(p,null,{default:f(()=>[(_(!0),C(M,null,A(m(v),b=>(_(),C("li",{key:b._id},[l(Z,{"model-value":b,icon:"fa-code",onOnEdit:E,onOnDelete:Y},{sub:f(()=>[c("p",null,"Công Nghệ: "+H(b.technology.join(", ")||""),1)]),_:2},1032,["model-value"])]))),128))]),_:1})])):(_(),L(q,{key:1}))]),l(z,{ref_key:"refModal",ref:a,title:m(t)._id?`Chỉnh sửa: ${m(t).school}`:"Thêm mới Dự án","is-hidden-footer":""},{default:f(()=>[c("div",oe,[l(N,{ref_key:"refVeeForm",ref:r,fields:u.value,document:m(t),"submit-fn":D,"submit-text":m(t)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:f(()=>[ae]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{re as default};
