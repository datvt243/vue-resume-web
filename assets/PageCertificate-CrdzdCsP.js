import{_ as R}from"./VeeForm-B-b2OAwq.js";import{u as H,_ as j,f as x}from"./Modal-xiQnTU33.js";import{h as C,s as A,r as l,o as f,c as _,b as d,a,w as u,f as n,k as K,F as v,C as P,H as S}from"./index-DTtE90NA.js";import{a as O}from"./useDocument-CVp39-DE.js";import{d as U,e as G,f as J,c as Q}from"./model.type-DgU_9viQ.js";const w="Vui lòng nhập",y=[U,{name:"name",label:"Tên Chứng chỉ",type:"text",placeholder:"Vui lòng nhập Tên Chứng chỉ",valid:m=>m.string().max(100,"Tối đa 100 ký tự").required(w),default:""},{name:"organization",label:"Tên tổ chức",type:"text",placeholder:"Vui lòng nhập Tên tổ chức",valid:m=>m.string().max(100,"Tối đa 100 ký tự").required(w),default:""},...G(!0),J({name:"isNoExpiration",label:"Không thời hạn"}),Q({name:"description",label:"Mô tả",required:!1})],W={class:"mb-4"},X={class:"btn-group"},Z={key:0,class:"clearfix"},tt={class:"btn-group"},et=["onClick"],nt=["onClick"],ot={class:"block-container"},at=d("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),lt={__name:"PageCertificate",setup(m){const{certificates:g,removeRecordById:T,addRecordToList:E,getData:M}=H({field:"certificates"}),{document:s,updateDoc:N,deleteDoc:$}=O({collection:"certificate",fields:y}),p=C(),k=C(),h=A(y);async function B(c){const e=(t=>(t.startDate=+new Date(t.startDate),t.endDate=+new Date(t.endDate),!t.isNoExpiration&&(t.isNoExpiration=!1),t))({...c});await N(e,t=>{const{data:i}=t;E(i)})}function Y(c){var t;const e=h.value.map(i=>i.name);for(const i of new Set(["_id",...e]))s[i]=c[i];!s.isNoExpiration&&(s.isNoExpiration=!1),(t=p.value)==null||t.show()}function F(){var c,e;for(const t of h.value)s[t.name]=t.default;(c=p.value)==null||c.show(),(e=k.value)==null||e.reset()}return(c,e)=>{const t=l("Button"),i=l("Heading"),D=l("FontAwesomeIcon"),V=l("ListTransition"),L=l("NoData");return f(),_(v,null,[d("div",W,[a(i,{text:"Chứng chỉ"},{default:u(()=>[d("div",X,[a(t,{onClick:e[0]||(e[0]=o=>F()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),a(t,{onClick:e[1]||(e[1]=o=>{var r;return(r=n(M))==null?void 0:r()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),n(g).length?(f(),_("div",Z,[a(V,null,{default:u(()=>[(f(!0),_(v,null,P(n(g),o=>(f(),_("li",{key:o._id},[a(S,{"model-value":{title:o.name,subTitle:o.organization,date:()=>{const{startDate:r,endDate:b,isNoExpiration:q}=o,z=n(x)(r,"MM/YYYY"),I=q?"Không thời hạn":n(x)(b,"MM/YYYY");return`${z} - ${I}`},description:o.description},icon:"fa-certificate"},{default:u(()=>[d("div",tt,[d("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:()=>{n($)({...o},"name",r=>{const{data:b}=r;n(T)(b._id)})}},[a(D,{icon:"fa-solid fa-trash"})],8,et),d("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:r=>Y({...o})},[a(D,{icon:"fa-solid fa-square-pen"})],8,nt)])]),_:2},1032,["model-value"])]))),128))]),_:1})])):(f(),K(L,{key:1}))]),a(j,{ref_key:"refModal",ref:p,title:n(s)._id?`Chỉnh sửa: ${n(s).name}`:"Thêm mới Chứng chỉ","is-hidden-footer":""},{default:u(()=>[d("div",ot,[a(R,{ref_key:"refVeeForm",ref:k,fields:h.value,document:n(s),"submit-fn":B,"submit-text":n(s)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:u(()=>[at]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{lt as default};
