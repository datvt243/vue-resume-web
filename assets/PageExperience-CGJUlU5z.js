import{_ as B}from"./VeeForm-BJctlgFg.js";import{u as A,_ as O}from"./Modal-BPO51vYk.js";import{v as R,p as C,x as V,r as f,o as p,k as F,w as b,b as r,a as i,y as w,h as I,s as j,c as x,f as m,F as M,z as H}from"./index-C58pkSHQ.js";import{a as K}from"./useDocument-CB5uqDja.js";const P={class:"btn-group"},z=R({__name:"ExperienceItem",props:{modelValue:{type:Object,default:()=>({_id:"",company:"",position:"",startDate:+new Date,endDate:+new Date,isCurrent:!1,description:"",image:"",website:""})}},emits:["onEdit","onDelete"],setup(t,{emit:v}){const D=v,g=t,u=C(()=>g.modelValue),n=C(()=>{const{startDate:y,endDate:o,isCurrent:c}=g.modelValue,d=V(y,"MM/YYYY"),_=c?"Hiện tại":V(o,"MM/YYYY");return`${d} - ${_}`}),k=C(()=>({title:u.value.company,subTitle:u.value.position,date:n.value,description:u.value.description}));return(y,o)=>{const c=f("FontAwesomeIcon"),d=f("ItemTemplate");return p(),F(d,{"model-value":k.value},{default:b(()=>[r("div",P,[r("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:o[0]||(o[0]=_=>D("onDelete",{...u.value}))},[i(c,{icon:"fa-solid fa-trash"})]),r("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:o[1]||(o[1]=_=>D("onEdit",{...u.value}))},[i(c,{icon:"fa-solid fa-square-pen"})])])]),_:1},8,["model-value"])}}}),h="Vui lòng nhập",$=[{name:"_id",label:"ID",type:"hidden",placeholder:"Vui lòng nhập ID",valid:t=>t.mixed().nullable().default(null),col:"col-md-12",default:null},{name:"company",label:"Tên công ty",type:"text",placeholder:"Vui lòng nhập Tên công ty",valid:t=>t.string().max(100,"Tối đa 100 ký tự").required(h),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:t=>t.string().max(50,"Tối đa 50 ký tự").required(h),default:""},{name:"startDate",label:"Ngày bắt đầu",type:"date",placeholder:"Vui lòng nhập Ngày bắt đầu",valid:t=>t.string().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"endDate",label:"Ngày Kết thúc",type:"date",placeholder:"Vui lòng nhập Ngày Kết thúc",valid:t=>t.string().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"isCurrent",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:t=>t.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},{name:"description",label:"Mô tả",type:"ckediter",valid:t=>t.string().required(h),col:"col-md-12",convertTo:"truncate",default:""}],S={class:"mb-4"},U={key:0,class:"clearfix"},G={class:"block-container"},J=r("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ee={__name:"PageExperience",setup(t){const{experiences:v,removeRecordById:D,addRecordToList:g,getData:u}=A({field:"experiences"}),{document:n,updateDoc:k,deleteDoc:y}=K({collection:"experience",fields:$}),o=I(),c=I(),d=j($);async function _(s){const a=(e=>(e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),!e.isCurrent&&(e.isCurrent=!1),e))({...s});await k(a,e=>{const{data:l}=e;g(l)})}async function E(s){y({...s},"company",a=>{const{data:e}=a;D(e._id)})}function N(s){var e;const a=d.value.map(l=>l.name);for(const l of new Set(["_id",...a]))n[l]=s[l];n.startDate=w(n.startDate),n.endDate=w(n.endDate),(e=o.value)==null||e.show()}function Y(){var s,a;for(const e of d.value)n[e.name]=e.default;(s=o.value)==null||s.show(),(a=c.value)==null||a.reset()}return(s,a)=>{const e=f("FontAwesomeIcon"),l=f("Heading"),q=f("ListTransition"),L=f("NoData");return p(),x(M,null,[r("div",S,[i(l,{text:"Kinh nghiệm làm việc"},{default:b(()=>[r("button",{class:"btn btn-sm btn-success",onClick:a[0]||(a[0]=T=>Y())},[i(e,{icon:"fa-solid fa-plus"})])]),_:1}),m(v).length?(p(),x("div",U,[i(q,null,{default:b(()=>[(p(!0),x(M,null,H(m(v),T=>(p(),x("li",{key:T._id},[i(z,{"model-value":T,icon:"fa-building",onOnEdit:N,onOnDelete:E},null,8,["model-value"])]))),128))]),_:1})])):(p(),F(L,{key:1}))]),i(O,{ref_key:"refModal",ref:o,title:m(n)._id?`Chỉnh sửa: ${m(n).school}`:"Thêm mới kinh nghiệm làm việc","is-hidden-footer":""},{default:b(()=>[r("div",G,[i(B,{ref_key:"refVeeForm",ref:c,fields:d.value,document:m(n),"submit-fn":_,"submit-text":m(n)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:b(()=>[J]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ee as default};
