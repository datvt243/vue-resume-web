import{_ as B}from"./VeeForm-CWEsd3gj.js";import{u as H,_ as R}from"./Modal-Biz4i9BD.js";import{v as A,p as x,x as I,r as p,o as f,k as V,w as b,b as d,a as l,y as w,h as M,s as O,c as T,e as m,d as K,T as P,F as N,z}from"./index-_cXkeK-O.js";import{a as S}from"./useDocument-DjZvQOz-.js";const U={class:"btn-group"},G=A({__name:"EducationItem",props:{modelValue:{type:Object,default:()=>({_id:"",school:"",major:"",startDate:+new Date,endDate:+new Date,isCurrent:!1,description:"",image:""})}},emits:["onEdit","onDelete"],setup(t,{emit:v}){const D=v,g=t,c=x(()=>g.modelValue),o=x(()=>{const{startDate:y,endDate:a,isCurrent:r}=g.modelValue,u=I(y,"MM/YYYY"),_=r?"Hiện tại":I(a,"MM/YYYY");return`${u} - ${_}`}),C=x(()=>({title:c.value.school,subTitle:c.value.major,date:o.value,description:c.value.description}));return(y,a)=>{const r=p("FontAwesomeIcon"),u=p("ItemTemplate");return f(),V(u,{"model-value":C.value},{default:b(()=>[d("div",U,[d("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:a[0]||(a[0]=_=>D("onDelete",{...c.value}))},[l(r,{icon:"fa-solid fa-trash"})]),d("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=_=>D("onEdit",{...c.value}))},[l(r,{icon:"fa-solid fa-square-pen"})])])]),_:1},8,["model-value"])}}}),h="Vui lòng nhập",F=[{name:"_id",label:"ID",type:"hidden",placeholder:"Vui lòng nhập Tên trường",valid:t=>t.string().nullable().default(null),col:"col-md-12",default:null},{name:"school",label:"Tên trường",type:"text",placeholder:"Vui lòng nhập Tên trường",valid:t=>t.string().max(100,"Tối đa 100 ký tự").required(h),default:""},{name:"major",label:"Chuyên ngành",type:"text",placeholder:"Vui lòng nhập Chuyên nhành",valid:t=>t.string().max(50,"Tối đa 50 ký tự").required(h),default:""},{name:"startDate",label:"Ngày bắt đầu",type:"date",placeholder:"Vui lòng nhập Ngày bắt đầu",valid:t=>t.date().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"endDate",label:"Ngày Kết thúc",type:"date",placeholder:"Vui lòng nhập Ngày Kết thúc",valid:t=>t.date().required(h).min(t.ref("startDate"),"Ngày kết thúc phải sau ngày bắt đầu"),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"isCurrent",label:"Đang học tại đây",type:"checkbox",placeholder:"",default:!1,valid:t=>t.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},{name:"description",label:"Mô tả",type:"ckediter",valid:t=>t.string().required(h),col:"col-md-12",convertTo:"truncate",default:""}],J={class:"mb-4"},Q={key:0,class:"clearfix"},W={class:"block-container"},X=d("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),oe={__name:"PageEducation",setup(t){const{educations:v,removeRecordById:D,addRecordToList:g,getData:c}=H({field:"educations",collection:"education"}),{document:o,updateDoc:C,deleteDoc:y}=S({collection:"education",fields:F}),a=M(),r=M(),u=O(F);async function _(s){const n=(e=>(e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),!e.isCurrent&&(e.isCurrent=!1),e))({...s});await C(n,e=>{const{data:i}=e;g(i)})}async function E(s){y({...s},"school",n=>{const{data:e}=n;D(e._id)})}function Y(s){var e;const n=u.value.map(i=>i.name);for(const i of new Set(["_id",...n]))o[i]=s[i];o.startDate=w(o.startDate),o.endDate=w(o.endDate),(e=a.value)==null||e.show()}function q(){var s,n;for(const e of u.value)o[e.name]=e.default;(s=a.value)==null||s.show(),(n=r.value)==null||n.reset()}return(s,n)=>{const e=p("FontAwesomeIcon"),i=p("Heading"),j=p("ListTransition"),L=p("NoData");return f(),T(N,null,[d("div",J,[l(i,{text:"Học vấn"},{default:b(()=>[d("button",{class:"btn btn-sm btn-success",onClick:n[0]||(n[0]=k=>q())},[l(e,{icon:"fa-solid fa-plus"})])]),_:1}),(f(),V(P,{to:"#reload"},[d("button",{class:"btn btn-sm btn-outline-info",onClick:n[1]||(n[1]=k=>{var $;return($=m(c))==null?void 0:$()})},[l(e,{icon:"fa-solid fa-repeat"}),K(" Reload ")])])),m(v).length?(f(),T("div",Q,[l(j,null,{default:b(()=>[(f(!0),T(N,null,z(m(v),k=>(f(),T("li",{key:k._id},[l(G,{"model-value":k,icon:"fa-graduation-cap",onOnEdit:Y,onOnDelete:E},null,8,["model-value"])]))),128))]),_:1})])):(f(),V(L,{key:1}))]),l(R,{ref_key:"refModal",ref:a,title:m(o)._id?`Chỉnh sửa: ${m(o).school}`:"Thêm mới Học vấn","is-hidden-footer":""},{default:b(()=>[d("div",W,[l(B,{ref_key:"refVeeForm",ref:r,fields:u.value,document:m(o),"submit-fn":_,"submit-text":m(o)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:b(()=>[X]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{oe as default};
