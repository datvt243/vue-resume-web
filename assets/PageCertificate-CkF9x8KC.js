import{_ as Y}from"./VeeForm-BE4iP4uH.js";import{u as z,_ as j}from"./useCandidate-D_rKPtCI.js";import{h as k,s as A,c as m,b as r,a as i,w as d,e as n,k as H,F as x,r as _,o as l,z as K,C as P,x as C,y as v}from"./index-BVJ7n5iW.js";import{a as S}from"./useDocument-CzQCdGR-.js";import{d as O,e as U,f as G,g as J,c as Q}from"./model.type-COLLnu_S.js";import"./regex.config-BmDLDyGj.js";const w="Vui lòng nhập",T=[O,{name:"name",label:"Tên Chứng chỉ",type:"text",placeholder:"Vui lòng nhập Tên Chứng chỉ",valid:f=>f.string().max(100,"Tối đa 100 ký tự").required(w),default:""},{name:"organization",label:"Tên tổ chức",type:"text",placeholder:"Vui lòng nhập Tên tổ chức",valid:f=>f.string().max(100,"Tối đa 100 ký tự").required(w),default:""},...U(),G({name:"isNoExpiration",label:"Không thời hạn"}),J({name:"link",label:"Link"}),Q({name:"description",label:"Mô tả"})],W={class:"mb-4"},X={key:0,class:"clearfix"},Z={class:"btn-group"},tt=["onClick"],et=["onClick"],nt={class:"block-container"},at=r("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),lt={__name:"PageCertificate",setup(f){const{certificates:D,removeRecordById:y,addRecordToList:E}=z({field:"certificates"}),{document:e,updateDoc:N,deleteDoc:L}=S({collection:"certificate",fields:T}),h=k(),g=k(),p=A(T);async function M(c){const a=(t=>(t.startDate=+new Date(t.startDate),t.endDate=+new Date(t.endDate),!t.isNoExpiration&&(t.isNoExpiration=!1),t))({...c});await N(a,t=>{const{data:o}=t;E(o)})}function $(c){var t;const a=p.value.map(o=>o.name);for(const o of new Set(["_id",...a]))e[o]=c[o];e.startDate=v(e.startDate),e.endDate=v(e.endDate),!e.isNoExpiration&&(e.isNoExpiration=!1),(t=h.value)==null||t.show()}function F(){var c,a;for(const t of p.value)e[t.name]=t.default;(c=h.value)==null||c.show(),(a=g.value)==null||a.reset()}return(c,a)=>{const t=_("FontAwesomeIcon"),o=_("Heading"),V=_("ListTransition"),B=_("NoData");return l(),m(x,null,[r("div",W,[i(o,{text:"Chứng chỉ"},{default:d(()=>[r("button",{class:"btn btn-sm btn-success",onClick:a[0]||(a[0]=s=>F())},[i(t,{icon:"fa-solid fa-plus"})])]),_:1}),n(D).length?(l(),m("div",X,[i(V,null,{default:d(()=>[(l(!0),m(x,null,K(n(D),s=>(l(),m("li",{key:s._id},[i(P,{"model-value":{title:s.name,subTitle:s.organization,date:()=>{const{startDate:u,endDate:b,isNoExpiration:I}=s,q=n(C)(u),R=I?"Không thời hạn":n(C)(b);return`${q} - ${R}`},description:s.description},icon:"fa-certificate"},{default:d(()=>[r("div",Z,[r("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:()=>{n(L)({...s},"name",u=>{const{data:b}=u;n(y)(b._id)})}},[i(t,{icon:"fa-solid fa-trash"})],8,tt),r("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:u=>$({...s})},[i(t,{icon:"fa-solid fa-square-pen"})],8,et)])]),_:2},1032,["model-value"])]))),128))]),_:1})])):(l(),H(B,{key:1}))]),i(j,{ref_key:"refModal",ref:h,title:n(e)._id?`Chỉnh sửa: ${n(e).school}`:"Thêm mới Chứng chỉ","is-hidden-footer":""},{default:d(()=>[r("div",nt,[i(Y,{ref_key:"refVeeForm",ref:g,fields:p.value,document:n(e),"submit-fn":M,"submit-text":n(e)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:d(()=>[at]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{lt as default};
