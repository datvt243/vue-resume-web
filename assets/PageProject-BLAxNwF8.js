import{_ as q}from"./VeeForm-CWEsd3gj.js";import{u as A,_ as R}from"./Modal-Biz4i9BD.js";import{v as W,p as C,x as j,r as b,o as f,k as V,w as p,A as O,b as d,B as P,a as i,h as I,s as S,c as w,e as u,d as H,T as z,F as M,z as U,C as G,y as F}from"./index-_cXkeK-O.js";import{a as J}from"./useDocument-DjZvQOz-.js";import{d as K,e as Q,f as X,c as Z}from"./model.type-neKQSWFc.js";const ee={class:"btn-group"},te=W({__name:"ProjectItem",props:{modelValue:{type:Object,default:()=>({_id:"",name:"",position:"",technology:"",startDate:+new Date,endDate:+new Date,isWorking:!1,description:"",link:"",image:""})}},emits:["onEdit","onDelete"],setup(o,{emit:v}){const k=v,y=o,c=C(()=>y.modelValue),t=C(()=>{const{startDate:g,endDate:a,isWorking:r}=y.modelValue,m=j(g,"MM/YYYY"),h=r?"Hiện tại":j(a,"MM/YYYY");return`${m} - ${h}`}),x=C(()=>({title:c.value.name,subTitle:c.value.position,date:t.value,description:c.value.description}));return(g,a)=>{const r=b("FontAwesomeIcon"),m=b("ItemTemplate");return f(),V(m,{"model-value":x.value},{sub:p(()=>[O(g.$slots,"sub")]),default:p(()=>[d("div",ee,[d("a",{class:P(["btn btn-sm btn-outline-danger icon",{disabled:!c.value._id}]),href:"javascript:void(0)",onClick:a[0]||(a[0]=h=>k("onDelete",{...c.value}))},[i(r,{icon:"fa-solid fa-trash"})],2),d("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=h=>k("onEdit",{...c.value}))},[i(r,{icon:"fa-solid fa-square-pen"})])])]),_:3},8,["model-value"])}}}),T="Vui lòng nhập",L=[K,{name:"name",label:"Tên dự án",type:"text",placeholder:"Vui lòng nhập Tên dự án",valid:o=>o.string().max(100,"Tối đa 100 ký tự").required(T),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:o=>o.string().max(50,"Tối đa 50 ký tự").required(T),default:""},{name:"technology",label:"Công nghệ sử dụng",type:"text",placeholder:"Vui lòng nhập Công nghệ sử dụng",valid:o=>o.string().required(T),default:""},...Q(),{name:"isWorking",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:o=>o.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},X({name:"link",label:"Link"}),Z({name:"description",label:"Mô tả"})],ne={class:"mb-4"},oe={key:0,class:"clearfix"},ae={class:"block-container"},se=d("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),me={__name:"PageProject",setup(o){const{projects:v,removeRecordById:k,addRecordToList:y,getData:c}=A({field:"projects"}),{document:t,updateDoc:x,deleteDoc:g}=J({collection:"project",fields:L}),a=I(),r=I(),m=S(L);async function h(s){const n=(e=>{var l;return e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),e.technology=(l=e.technology)==null?void 0:l.split(","),!e.isWorking&&(e.isWorking=!1),e})({...s});await x(n,e=>{const{data:l}=e;y(l)})}async function Y(s){g({...s},"name",n=>{const{data:e}=n;k(e._id)})}function E(s){var e,l;const n=m.value.map(_=>_.name);for(const _ of new Set(["_id",...n]))t[_]=s[_];t.technology=(e=t.technology)==null?void 0:e.join(", "),t.startDate=F(t.startDate),t.endDate=F(t.endDate),(l=a.value)==null||l.show()}function B(){var s,n;for(const e of m.value)t[e.name]=e.default;(s=a.value)==null||s.show(),(n=r.value)==null||n.reset()}return(s,n)=>{const e=b("FontAwesomeIcon"),l=b("Heading"),_=b("ListTransition"),N=b("NoData");return f(),w(M,null,[d("div",ne,[i(l,{text:"Dự án"},{default:p(()=>[d("button",{class:"btn btn-sm btn-success",onClick:n[0]||(n[0]=D=>B())},[i(e,{icon:"fa-solid fa-plus"})])]),_:1}),(f(),V(z,{to:"#reload"},[d("button",{class:"btn btn-sm btn-outline-info",onClick:n[1]||(n[1]=D=>{var $;return($=u(c))==null?void 0:$()})},[i(e,{icon:"fa-solid fa-repeat"}),H(" Reload ")])])),u(v).length?(f(),w("div",oe,[i(_,null,{default:p(()=>[(f(!0),w(M,null,U(u(v),D=>(f(),w("li",{key:D._id},[i(te,{"model-value":D,icon:"fa-code",onOnEdit:E,onOnDelete:Y},{sub:p(()=>[d("p",null,"Công Nghệ: "+G(D.technology.join(", ")||""),1)]),_:2},1032,["model-value"])]))),128))]),_:1})])):(f(),V(N,{key:1}))]),i(R,{ref_key:"refModal",ref:a,title:u(t)._id?`Chỉnh sửa: ${u(t).school}`:"Thêm mới Dự án","is-hidden-footer":""},{default:p(()=>[d("div",ae,[i(q,{ref_key:"refVeeForm",ref:r,fields:m.value,document:u(t),"submit-fn":h,"submit-text":u(t)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:p(()=>[se]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{me as default};
