import{_ as R}from"./VeeForm-BJctlgFg.js";import{u as z,_ as j}from"./Modal-BPO51vYk.js";import{h as k,s as A,r as m,o as d,c as _,b as r,a as i,w as l,f as n,k as H,F as x,z as K,D as P,x as C,y as v}from"./index-C58pkSHQ.js";import{a as S}from"./useDocument-CB5uqDja.js";import{d as O,e as U,g as G,f as J,c as Q}from"./model.type-CMRk_XPP.js";const w="Vui lòng nhập",T=[O,{name:"name",label:"Tên Chứng chỉ",type:"text",placeholder:"Vui lòng nhập Tên Chứng chỉ",valid:f=>f.string().max(100,"Tối đa 100 ký tự").required(w),default:""},{name:"organization",label:"Tên tổ chức",type:"text",placeholder:"Vui lòng nhập Tên tổ chức",valid:f=>f.string().max(100,"Tối đa 100 ký tự").required(w),default:""},...U(),G({name:"isNoExpiration",label:"Không thời hạn"}),J({name:"link",label:"Link"}),Q({name:"description",label:"Mô tả"})],W={class:"mb-4"},X={key:0,class:"clearfix"},Z={class:"btn-group"},tt=["onClick"],et=["onClick"],nt={class:"block-container"},at=r("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),lt={__name:"PageCertificate",setup(f){const{certificates:D,removeRecordById:y,addRecordToList:E,getData:ot}=z({field:"certificates"}),{document:e,updateDoc:M,deleteDoc:N}=S({collection:"certificate",fields:T}),h=k(),g=k(),p=A(T);async function L(c){const a=(t=>(t.startDate=+new Date(t.startDate),t.endDate=+new Date(t.endDate),!t.isNoExpiration&&(t.isNoExpiration=!1),t))({...c});await M(a,t=>{const{data:o}=t;E(o)})}function Y(c){var t;const a=p.value.map(o=>o.name);for(const o of new Set(["_id",...a]))e[o]=c[o];e.startDate=v(e.startDate),e.endDate=v(e.endDate),!e.isNoExpiration&&(e.isNoExpiration=!1),(t=h.value)==null||t.show()}function $(){var c,a;for(const t of p.value)e[t.name]=t.default;(c=h.value)==null||c.show(),(a=g.value)==null||a.reset()}return(c,a)=>{const t=m("FontAwesomeIcon"),o=m("Heading"),F=m("ListTransition"),V=m("NoData");return d(),_(x,null,[r("div",W,[i(o,{text:"Chứng chỉ"},{default:l(()=>[r("button",{class:"btn btn-sm btn-success",onClick:a[0]||(a[0]=s=>$())},[i(t,{icon:"fa-solid fa-plus"})])]),_:1}),n(D).length?(d(),_("div",X,[i(F,null,{default:l(()=>[(d(!0),_(x,null,K(n(D),s=>(d(),_("li",{key:s._id},[i(P,{"model-value":{title:s.name,subTitle:s.organization,date:()=>{const{startDate:u,endDate:b,isNoExpiration:B}=s,I=n(C)(u,"MM/YYYY"),q=B?"Không thời hạn":n(C)(b,"MM/YYYY");return`${I} - ${q}`},description:s.description},icon:"fa-certificate"},{default:l(()=>[r("div",Z,[r("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:()=>{n(N)({...s},"name",u=>{const{data:b}=u;n(y)(b._id)})}},[i(t,{icon:"fa-solid fa-trash"})],8,tt),r("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:u=>Y({...s})},[i(t,{icon:"fa-solid fa-square-pen"})],8,et)])]),_:2},1032,["model-value"])]))),128))]),_:1})])):(d(),H(V,{key:1}))]),i(j,{ref_key:"refModal",ref:h,title:n(e)._id?`Chỉnh sửa: ${n(e).school}`:"Thêm mới Chứng chỉ","is-hidden-footer":""},{default:l(()=>[r("div",nt,[i(R,{ref_key:"refVeeForm",ref:g,fields:p.value,document:n(e),"submit-fn":L,"submit-text":n(e)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:l(()=>[at]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{lt as default};
