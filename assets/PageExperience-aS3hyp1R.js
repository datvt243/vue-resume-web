import{_ as O}from"./VeeForm-Duwk6dER.js";import{u as R,_ as j}from"./Modal-DFIulcsf.js";import{x as z,p as T,y as $,r as f,o as p,k as N,w as v,b as m,a as l,z as w,h as M,s as A,c as k,f as u,F as I,A as H}from"./index-DhJAbDsU.js";import{a as K}from"./useDocument-p6YVppS_.js";const P={class:"btn-group"},S=z({__name:"ExperienceItem",props:{modelValue:{type:Object,default:()=>({_id:"",company:"",position:"",startDate:+new Date,endDate:+new Date,isCurrent:!1,description:"",image:"",website:""})}},emits:["onEdit","onDelete"],setup(t,{emit:b}){const D=b,g=t,c=T(()=>g.modelValue),o=T(()=>{const{startDate:y,endDate:a,isCurrent:d}=g.modelValue,r=$(y,"MM/YYYY"),_=d?"Hiện tại":$(a,"MM/YYYY");return`${r} - ${_}`}),C=T(()=>({title:c.value.company,subTitle:c.value.position,date:o.value,description:c.value.description}));return(y,a)=>{const d=f("FontAwesomeIcon"),r=f("ItemTemplate");return p(),N(r,{"model-value":C.value},{default:v(()=>[m("div",P,[m("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:a[0]||(a[0]=_=>D("onDelete",{...c.value}))},[l(d,{icon:"fa-solid fa-trash"})]),m("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=_=>D("onEdit",{...c.value}))},[l(d,{icon:"fa-solid fa-square-pen"})])])]),_:1},8,["model-value"])}}}),h="Vui lòng nhập",E=[{name:"_id",label:"ID",type:"hidden",placeholder:"Vui lòng nhập ID",valid:t=>t.mixed().nullable().default(null),col:"col-md-12",default:null},{name:"company",label:"Tên công ty",type:"text",placeholder:"Vui lòng nhập Tên công ty",valid:t=>t.string().max(100,"Tối đa 100 ký tự").required(h),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:t=>t.string().max(50,"Tối đa 50 ký tự").required(h),default:""},{name:"startDate",label:"Ngày bắt đầu",type:"date",placeholder:"Vui lòng nhập Ngày bắt đầu",valid:t=>t.string().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"endDate",label:"Ngày Kết thúc",type:"date",placeholder:"Vui lòng nhập Ngày Kết thúc",valid:t=>t.string().required(h),col:"col-md-6",convertTo:"date",default:w(+new Date)},{name:"isCurrent",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:t=>t.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},{name:"description",label:"Mô tả",type:"ckediter",valid:t=>t.string().required(h),col:"col-md-12",convertTo:"truncate",default:""}],U={class:"mb-4"},G={class:"btn-group"},J={key:0,class:"clearfix"},Q={class:"block-container"},W=m("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ne={__name:"PageExperience",setup(t){const{experiences:b,removeRecordById:D,addRecordToList:g,getData:c}=R({field:"experiences"}),{document:o,updateDoc:C,deleteDoc:y}=K({collection:"experience",fields:E}),a=M(),d=M(),r=A(E);async function _(s){const n=(e=>(e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),!e.isCurrent&&(e.isCurrent=!1),e))({...s});await C(n,e=>{const{data:i}=e;g(i)})}async function Y(s){y({...s},"company",n=>{const{data:e}=n;D(e._id)})}function q(s){var e;const n=r.value.map(i=>i.name);for(const i of new Set(["_id",...n]))o[i]=s[i];o.startDate=w(o.startDate),o.endDate=w(o.endDate),(e=a.value)==null||e.show()}function B(){var s,n;for(const e of r.value)o[e.name]=e.default;(s=a.value)==null||s.show(),(n=d.value)==null||n.reset()}return(s,n)=>{const e=f("Button"),i=f("Heading"),F=f("ListTransition"),L=f("NoData");return p(),k(I,null,[m("div",U,[l(i,{text:"Kinh nghiệm làm việc"},{default:v(()=>[m("div",G,[l(e,{onClick:n[0]||(n[0]=x=>B()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),l(e,{onClick:n[1]||(n[1]=x=>{var V;return(V=u(c))==null?void 0:V()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),u(b).length?(p(),k("div",J,[l(F,null,{default:v(()=>[(p(!0),k(I,null,H(u(b),x=>(p(),k("li",{key:x._id},[l(S,{"model-value":x,icon:"fa-building",onOnEdit:q,onOnDelete:Y},null,8,["model-value"])]))),128))]),_:1})])):(p(),N(L,{key:1}))]),l(j,{ref_key:"refModal",ref:a,title:u(o)._id?`Chỉnh sửa: ${u(o).school}`:"Thêm mới kinh nghiệm làm việc","is-hidden-footer":""},{default:v(()=>[m("div",Q,[l(O,{ref_key:"refVeeForm",ref:d,fields:r.value,document:u(o),"submit-fn":_,"submit-text":u(o)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:v(()=>[W]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ne as default};
