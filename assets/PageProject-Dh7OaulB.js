import{_ as q}from"./VeeForm-BJctlgFg.js";import{u as A,_ as N}from"./Modal-BPO51vYk.js";import{v as W,p as C,x as V,r as g,o as _,k as F,w as u,A as O,b as c,B as P,a as i,h as $,s as R,c as w,f as p,F as j,z as S,C as H,y as I}from"./index-C58pkSHQ.js";import{a as z}from"./useDocument-CB5uqDja.js";import{d as U,e as G,f as J,c as K}from"./model.type-CMRk_XPP.js";const Q={class:"btn-group"},X=W({__name:"ProjectItem",props:{modelValue:{type:Object,default:()=>({_id:"",name:"",position:"",technology:"",startDate:+new Date,endDate:+new Date,isWorking:!1,description:"",link:"",image:""})}},emits:["onEdit","onDelete"],setup(o,{emit:D}){const v=D,k=o,d=C(()=>k.modelValue),t=C(()=>{const{startDate:h,endDate:a,isWorking:r}=k.modelValue,m=V(h,"MM/YYYY"),b=r?"Hiện tại":V(a,"MM/YYYY");return`${m} - ${b}`}),x=C(()=>({title:d.value.name,subTitle:d.value.position,date:t.value,description:d.value.description}));return(h,a)=>{const r=g("FontAwesomeIcon"),m=g("ItemTemplate");return _(),F(m,{"model-value":x.value},{sub:u(()=>[O(h.$slots,"sub")]),default:u(()=>[c("div",Q,[c("a",{class:P(["btn btn-sm btn-outline-danger icon",{disabled:!d.value._id}]),href:"javascript:void(0)",onClick:a[0]||(a[0]=b=>v("onDelete",{...d.value}))},[i(r,{icon:"fa-solid fa-trash"})],2),c("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=b=>v("onEdit",{...d.value}))},[i(r,{icon:"fa-solid fa-square-pen"})])])]),_:3},8,["model-value"])}}}),T="Vui lòng nhập",M=[U,{name:"name",label:"Tên dự án",type:"text",placeholder:"Vui lòng nhập Tên dự án",valid:o=>o.string().max(100,"Tối đa 100 ký tự").required(T),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:o=>o.string().max(50,"Tối đa 50 ký tự").required(T),default:""},{name:"technology",label:"Công nghệ sử dụng",type:"text",placeholder:"Vui lòng nhập Công nghệ sử dụng",valid:o=>o.string().required(T),default:""},...G(),{name:"isWorking",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:o=>o.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},J({name:"link",label:"Link"}),K({name:"description",label:"Mô tả"})],Z={class:"mb-4"},ee={key:0,class:"clearfix"},te={class:"block-container"},ne=c("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ce={__name:"PageProject",setup(o){const{projects:D,removeRecordById:v,addRecordToList:k,getData:d}=A({field:"projects"}),{document:t,updateDoc:x,deleteDoc:h}=z({collection:"project",fields:M}),a=$(),r=$(),m=R(M);async function b(s){const n=(e=>{var l;return e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),e.technology=(l=e.technology)==null?void 0:l.split(","),!e.isWorking&&(e.isWorking=!1),e})({...s});await x(n,e=>{const{data:l}=e;k(l)})}async function L(s){h({...s},"name",n=>{const{data:e}=n;v(e._id)})}function Y(s){var e,l;const n=m.value.map(f=>f.name);for(const f of new Set(["_id",...n]))t[f]=s[f];t.technology=(e=t.technology)==null?void 0:e.join(", "),t.startDate=I(t.startDate),t.endDate=I(t.endDate),(l=a.value)==null||l.show()}function E(){var s,n;for(const e of m.value)t[e.name]=e.default;(s=a.value)==null||s.show(),(n=r.value)==null||n.reset()}return(s,n)=>{const e=g("FontAwesomeIcon"),l=g("Heading"),f=g("ListTransition"),B=g("NoData");return _(),w(j,null,[c("div",Z,[i(l,{text:"Dự án"},{default:u(()=>[c("button",{class:"btn btn-sm btn-success",onClick:n[0]||(n[0]=y=>E())},[i(e,{icon:"fa-solid fa-plus"})])]),_:1}),p(D).length?(_(),w("div",ee,[i(f,null,{default:u(()=>[(_(!0),w(j,null,S(p(D),y=>(_(),w("li",{key:y._id},[i(X,{"model-value":y,icon:"fa-code",onOnEdit:Y,onOnDelete:L},{sub:u(()=>[c("p",null,"Công Nghệ: "+H(y.technology.join(", ")||""),1)]),_:2},1032,["model-value"])]))),128))]),_:1})])):(_(),F(B,{key:1}))]),i(N,{ref_key:"refModal",ref:a,title:p(t)._id?`Chỉnh sửa: ${p(t).school}`:"Thêm mới Dự án","is-hidden-footer":""},{default:u(()=>[c("div",te,[i(q,{ref_key:"refVeeForm",ref:r,fields:m.value,document:p(t),"submit-fn":b,"submit-text":p(t)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:u(()=>[ne]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ce as default};
