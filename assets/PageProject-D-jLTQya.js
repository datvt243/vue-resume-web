import{_ as E}from"./VeeForm-BWVJbg0D.js";import"./TableDefault.vue_vue_type_style_index_1_scoped_121b7854_lang-CgrnDAmN.js";import{u as A,_ as B}from"./useCandidate-qdEiIR-E.js";import{q as W,n as C,v as j,r as g,o as _,j as F,w as u,z as O,b as c,a as d,x as h,k as I,s as P,c as x,e as p,F as $,y as R,A as Y}from"./index-cGN05OM-.js";import{a as H}from"./useDocument-BQZPQPRV.js";const S={class:"btn-group"},K=W({__name:"ProjectItem",props:{modelValue:{type:Object,default:()=>({_id:"",name:"",position:"",technology:"",startDate:+new Date,endDate:+new Date,isWorking:!1,description:"",link:"",image:""})}},emits:["onEdit","onDelete"],setup(t,{emit:v}){const y=v,k=t,n=C(()=>k.modelValue),T=C(()=>{const{startDate:r,endDate:a,isWorking:i}=k.modelValue,b=j(r),D=i?"Hiện tại":j(a);return`${b} - ${D}`}),V=C(()=>({title:n.value.name,subTitle:n.value.position,date:T.value,description:n.value.description}));return(r,a)=>{const i=g("FontAwesomeIcon"),b=g("ItemTemplate");return _(),F(b,{"model-value":V.value},{sub:u(()=>[O(r.$slots,"sub")]),default:u(()=>[c("div",S,[c("a",{class:"btn btn-sm btn-outline-danger icon",href:"javascript:void(0)",onClick:a[0]||(a[0]=D=>y("onDelete",{...n.value}))},[d(i,{icon:"fa-solid fa-trash"})]),c("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:a[1]||(a[1]=D=>y("onEdit",{...n.value}))},[d(i,{icon:"fa-solid fa-square-pen"})])])]),_:3},8,["model-value"])}}}),f="Vui lòng nhập",q=[{name:"_id",label:"ID",type:"hidden",placeholder:"Vui lòng nhập ID",valid:t=>t.mixed().nullable().default(null),col:"col-md-12",default:null},{name:"name",label:"Tên dự án",type:"text",placeholder:"Vui lòng nhập Tên dự án",valid:t=>t.string().max(100,"Tối đa 100 ký tự").required(f),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:t=>t.string().max(50,"Tối đa 50 ký tự").required(f),default:""},{name:"technology",label:"Công nghệ sử dụng",type:"text",placeholder:"Vui lòng nhập Công nghệ sử dụng",valid:t=>t.string().required(f),default:""},{name:"startDate",label:"Ngày bắt đầu",type:"date",placeholder:"Vui lòng nhập Ngày bắt đầu",valid:t=>t.string().required(f).default(()=>h(+new Date)),col:"col-md-6",convertTo:"date",default:h(+new Date)},{name:"endDate",label:"Ngày Kết thúc",type:"date",placeholder:"Vui lòng nhập Ngày Kết thúc",valid:t=>t.string().required(f).default(()=>h(+new Date)),col:"col-md-6",convertTo:"date",default:h(+new Date)},{name:"isWorking",label:"Đang làm việc tại đây",type:"checkbox",placeholder:"",default:!1,valid:t=>t.boolean(),col:"col-md-12",cellClass:"text-center",convertTo:"boolean",checkedValue:!1},{name:"description",label:"Mô tả",type:"textarea",valid:t=>t.string().required(f),col:"col-md-12",convertTo:"truncate",default:""},{name:"link",label:"Link",type:"text",valid:t=>t.string().url().nullable(),col:"col-md-12",default:""}],z={class:"mb-4"},U={key:0,class:"clearfix"},G={class:"block-container"},J=c("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ne={__name:"PageProject",setup(t){const{projects:v,removeRecordById:y,addRecordToList:k}=A({field:"projects"}),{document:n,updateDoc:T,deleteDoc:V}=H({collection:"project",fields:q}),r=I(),a=I(),i=P(q);async function b(l){const o=(e=>{var s;return e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),e.technology=(s=e.technology)==null?void 0:s.split(","),!e.isWorking&&(e.isWorking=!1),e})({...l});await T(o,e=>{const{data:s}=e;k(s)})}async function D(l){V({...l},"company",o=>{const{data:e}=o;y(e._id)})}function N(l){var e,s;const o=i.value.map(m=>m.name);for(const m of new Set(["_id",...o]))n[m]=l[m];n.technology=(e=n.technology)==null?void 0:e.join(", "),n.startDate=h(n.startDate),n.endDate=h(n.endDate),(s=r.value)==null||s.show()}function M(){var l,o;for(const e of i.value)n[e.name]=e.default;(l=r.value)==null||l.show(),(o=a.value)==null||o.reset()}return(l,o)=>{const e=g("FontAwesomeIcon"),s=g("Heading"),m=g("ListTransition"),L=g("NoData");return _(),x($,null,[c("div",z,[d(s,{text:"Dự án"},{default:u(()=>[c("button",{class:"btn btn-sm btn-success",onClick:o[0]||(o[0]=w=>M())},[d(e,{icon:"fa-solid fa-plus"})])]),_:1}),p(v).length?(_(),x("div",U,[d(m,null,{default:u(()=>[(_(!0),x($,null,R(p(v),w=>(_(),x("li",{key:w._id},[d(K,{"model-value":w,icon:"fa-code",onOnEdit:N,onOnDelete:D},{sub:u(()=>[c("p",null,"Công Nghệ: "+Y(w.technology.join(", ")||""),1)]),_:2},1032,["model-value"])]))),128))]),_:1})])):(_(),F(L,{key:1}))]),d(B,{ref_key:"refModal",ref:r,title:p(n)._id?`Chỉnh sửa: ${p(n).school}`:"Thêm mới Dự án","is-hidden-footer":""},{default:u(()=>[c("div",G,[d(E,{ref_key:"refVeeForm",ref:a,fields:i.value,document:p(n),"submit-fn":b,"submit-text":p(n)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:u(()=>[J]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ne as default};
