import{_ as q}from"./VeeForm-B-b2OAwq.js";import{f as $,u as N,_ as W}from"./Modal-xiQnTU33.js";import{E as z,p as x,r as g,o as _,k as E,w as f,v as O,b as r,G as P,a as i,h as j,s as R,c as C,f as m,F as M,C as S,z as H}from"./index-DTtE90NA.js";import{a as A}from"./useDocument-CVp39-DE.js";import{d as G,e as U,f as J,g as K,c as Q}from"./model.type-DgU_9viQ.js";const X={class:"btn-group"},Z=z({__name:"ProjectItem",props:{modelValue:{type:Object,default:()=>({_id:"",name:"",position:"",technology:"",startDate:+new Date,endDate:+new Date,isWorking:!1,description:"",link:"",image:""})}},emits:["onEdit","onDelete"],setup(l,{emit:v}){const k=v,y=l,d=x(()=>y.modelValue),n=x(()=>{const{startDate:h,endDate:o,isWorking:c}=y.modelValue,u=$(h,"MM/YYYY"),b=c?"Hiện tại":$(o,"MM/YYYY");return`${u} - ${b}`}),w=x(()=>({title:d.value.name,subTitle:d.value.position,date:n.value,description:d.value.description}));return(h,o)=>{const c=g("FontAwesomeIcon"),u=g("ItemTemplate");return _(),E(u,{"model-value":w.value},{sub:f(()=>[O(h.$slots,"sub")]),default:f(()=>[r("div",X,[r("a",{class:P(["btn btn-sm btn-outline-danger icon",{disabled:!d.value._id}]),href:"javascript:void(0)",onClick:o[0]||(o[0]=b=>k("onDelete",{...d.value}))},[i(c,{icon:"fa-solid fa-trash"})],2),r("a",{class:"btn btn-sm btn-outline-warning icon",href:"javascript:void(0)",onClick:o[1]||(o[1]=b=>k("onEdit",{...d.value}))},[i(c,{icon:"fa-solid fa-square-pen"})])])]),_:3},8,["model-value"])}}}),V="Vui lòng nhập",B=[G,{name:"name",label:"Tên dự án",type:"text",placeholder:"Vui lòng nhập Tên dự án",valid:l=>l.string().max(100,"Tối đa 100 ký tự").required(V),default:""},{name:"position",label:"Vị trí",type:"text",placeholder:"Vui lòng nhập Vị trí",valid:l=>l.string().max(50,"Tối đa 50 ký tự").required(V),default:""},{name:"technology",label:"Công nghệ sử dụng",type:"text",placeholder:"Vui lòng nhập Công nghệ sử dụng",valid:l=>l.string().required(V),default:""},...U(!0),J({name:"isWorking",label:"Đang làm việc tại đây"}),K({name:"link",label:"Link"}),Q({name:"description",label:"Mô tả"})],ee={class:"mb-4"},te={class:"btn-group"},ne={key:0,class:"clearfix"},oe={class:"block-container"},ae=r("button",{type:"button",class:"btn btn-secondary mx-3","data-bs-dismiss":"modal"},"Đóng",-1),ce={__name:"PageProject",setup(l){const{projects:v,removeRecordById:k,addRecordToList:y,getData:d}=N({field:"projects"}),{document:n,updateDoc:w,deleteDoc:h}=A({collection:"project",fields:B}),o=j(),c=j(),u=R(B);async function b(a){const t=(e=>{var s;return e.startDate=+new Date(e.startDate),e.endDate=+new Date(e.endDate),e.technology=(s=e.technology)==null?void 0:s.split(","),!e.isWorking&&(e.isWorking=!1),e})({...a});await w(t,e=>{const{data:s}=e;y(s)})}async function L(a){h({...a},"name",t=>{const{data:e}=t;k(e._id)})}function Y(a){var e,s;const t=u.value.map(p=>p.name);for(const p of new Set(["_id",...t]))n[p]=a[p];n.technology=(e=n.technology)==null?void 0:e.join(", "),(s=o.value)==null||s.show()}function F(){var a,t;for(const e of u.value)n[e.name]=e.default;(a=o.value)==null||a.show(),(t=c.value)==null||t.reset()}return(a,t)=>{const e=g("Button"),s=g("Heading"),p=g("ListTransition"),I=g("NoData");return _(),C(M,null,[r("div",ee,[i(s,{text:"Dự án"},{default:f(()=>[r("div",te,[i(e,{onClick:t[0]||(t[0]=D=>F()),icon:"fa-solid fa-plus",type:"outline-success",size:"sm"}),i(e,{onClick:t[1]||(t[1]=D=>{var T;return(T=m(d))==null?void 0:T()}),icon:"fa-solid fa-repeat",type:"outline-info",size:"sm"})])]),_:1}),m(v).length?(_(),C("div",ne,[i(p,null,{default:f(()=>[(_(!0),C(M,null,S(m(v),D=>(_(),C("li",{key:D._id},[i(Z,{"model-value":D,icon:"fa-code",onOnEdit:Y,onOnDelete:L},{sub:f(()=>[r("p",null,"Công Nghệ: "+H(D.technology.join(", ")||""),1)]),_:2},1032,["model-value"])]))),128))]),_:1})])):(_(),E(I,{key:1}))]),i(W,{ref_key:"refModal",ref:o,title:m(n)._id?`Chỉnh sửa: ${m(n).name}`:"Thêm mới Dự án","is-hidden-footer":""},{default:f(()=>[r("div",oe,[i(q,{ref_key:"refVeeForm",ref:c,fields:u.value,document:m(n),"submit-fn":b,"submit-text":m(n)._id?"Cập nhật":"Thêm mới",buttonPosition:"end"},{button:f(()=>[ae]),_:1},8,["fields","document","submit-text"])])]),_:1},8,["title"])],64)}}};export{ce as default};
